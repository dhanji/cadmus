# Fibonacci search: search sorted list using Fibonacci numbers
# Example: search 7 in (1 3 5 7 9 11 13) = 3
# expected: 3

fibonacci_search:
  inputs:
    - lst: "List(Number)"
    - target: "Number"
  bindings:
    lst: "(list 1 3 5 7 9 11 13)"
    target: "7"
  steps:
    - let_bind:
        bindings: "[n (length lst)]"
        body: "(let fib-init ([f2 0] [f1 1]) (let ([f (+ f2 f1)]) (if (>= f n) (let loop ([f2 f2] [f1 f1] [f f] [offset -1]) (cond [(< f 1) -1] [else (let ([i (min (+ offset f2) (- n 1))]) (cond [(< (list-ref lst i) target) (loop (- f1 f2) f2 f1 i)] [(> (list-ref lst i) target) (loop (- f2 (- f1 f2)) (- f1 f2) f2 offset)] [else i]))])) (fib-init f1 f))))"
