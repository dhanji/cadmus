# Binary search: find index of target in sorted list, -1 if not found
# Example: search 7 in (1 3 5 7 9 11 13) = 3
# expected: 3

binary_search:
  inputs:
    - lst: "List(Number)"
    - target: "Number"
  bindings:
    lst: "(list 1 3 5 7 9 11 13)"
    target: "7"
  steps:
    - iterate:
        name: "loop"
        bindings: "lo=0 hi=(-(length lst) 1)"
        body: "(if (> lo hi) -1 (let ([mid (quotient (+ lo hi) 2)]) (let ([v (list-ref lst mid)]) (cond [(= v target) mid] [(< v target) (loop (+ mid 1) hi)] [else (loop lo (- mid 1))]))))"
