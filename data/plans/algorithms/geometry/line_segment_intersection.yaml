# Line segment intersection: do segments (0,0)-(2,2) and (0,2)-(2,0) intersect?
# Example: intersect? = #t
# expected: #t

line_segment_intersection:
  inputs:
    - n: "Number"
  bindings:
    n: "0"
  steps:
    - let_bind:
        bindings: "[cross (lambda (ox oy ax ay bx by) (- (* (- ax ox) (- by oy)) (* (- ay oy) (- bx ox))))]"
        body: "(let* ([d1 (cross 0 2 2 0 0 0)] [d2 (cross 0 2 2 0 2 2)] [d3 (cross 0 0 2 2 0 2)] [d4 (cross 0 0 2 2 2 0)]) (and (< (* d1 d2) 0) (< (* d3 d4) 0)))"
