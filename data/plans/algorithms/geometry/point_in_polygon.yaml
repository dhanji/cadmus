# Point in polygon: ray casting algorithm
# Example: point (1,1) in square (0,0)(4,0)(4,4)(0,4) = #t
# expected: #t

point_in_polygon:
  inputs:
    - n: "Number"
  bindings:
    n: "4"
  steps:
    - let_bind:
        bindings: "[px 1] [py 1] [xs (vector 0 4 4 0)] [ys (vector 0 0 4 4)]"
        body: "(odd? (for/sum ([i (in-range n)]) (let* ([j (modulo (+ i 1) n)] [xi (vector-ref xs i)] [yi (vector-ref ys i)] [xj (vector-ref xs j)] [yj (vector-ref ys j)]) (if (and (or (and (<= yi py) (> yj py)) (and (<= yj py) (> yi py))) (< px (+ xi (/ (* (- py yi) (- xj xi)) (- yj yi))))) 1 0))))"
