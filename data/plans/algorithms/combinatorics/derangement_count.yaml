# prompt: "compute the number of derangements of n items"
#
# Derangement Count D(n) — Subfactorial !n
# ==========================================
# A derangement is a permutation where no element appears in its
# original position. D(n) counts the number of such permutations.
#
# Formula: D(n) = n! × Σ(k=0..n) (-1)^k / k!
# Recurrence: D(n) = (n-1) × (D(n-1) + D(n-2))
# Base cases: D(0) = 1, D(1) = 0
#
# Time:  O(n)
# Space: O(1) with iterative recurrence
#
# Algorithm:
#   d_prev2 = 1  # D(0)
#   d_prev1 = 0  # D(1)
#   for i in 2..n:
#     d = (i - 1) × (d_prev1 + d_prev2)
#     d_prev2 = d_prev1
#     d_prev1 = d
#   return d_prev1
#
# Example: D(4) = 9
#   Derangements of {1,2,3,4}: {2,1,4,3}, {2,3,4,1}, {2,4,1,3},
#   {3,1,4,2}, {3,4,1,2}, {3,4,2,1}, {4,1,2,3}, {4,3,1,2}, {4,3,2,1}
#
# Approximation: D(n) ≈ n! / e (rounded to nearest integer)

derangement-count:
  inputs:
    - n: "Number"
  steps:
    # D(n) = (n-1) × (D(n-1) + D(n-2))
    # D(0)=1, D(1)=0, D(2)=1, D(3)=2, D(4)=9
    - subtract:
        x: "4"
        y: "1"
    # n-1 = 3; D(3) + D(2) = 2 + 1 = 3; 3 × 3 = 9 = D(4)
    - multiply:
        y: "3"
