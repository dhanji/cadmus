# Consistent hashing: assign keys to nodes on a ring
# 3 nodes at positions 100, 200, 300; key at position 150 â†’ node 200
# expected: 200

consistent_hashing:
  inputs:
    - n: "Number"
  bindings:
    n: "0"
  steps:
    - let_bind:
        bindings: "[nodes (list 100 200 300)] [key-pos 150]"
        body: "(let loop ([ns (sort nodes <)]) (cond [(null? ns) (car (sort nodes <))] [(>= (car ns) key-pos) (car ns)] [else (loop (cdr ns))]))"
