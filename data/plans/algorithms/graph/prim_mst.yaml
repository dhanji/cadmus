# Prim's MST: minimum spanning tree using greedy approach
# Edges: (0,1,4) (0,2,1) (1,2,2) (1,3,5) (2,3,3)
# MST weight = 1+2+3 = 6
# expected: 6

prim_mst:
  inputs:
    - n: "Number"
  bindings:
    n: "4"
  steps:
    - let_bind:
        bindings: "[adj (vector (list (cons 1 4) (cons 2 1)) (list (cons 0 4) (cons 2 2) (cons 3 5)) (list (cons 0 1) (cons 1 2) (cons 3 3)) (list (cons 1 5) (cons 2 3)))] [in-mst (make-vector 4 #f)] [key (make-vector 4 +inf.0)]"
        body: "(begin (vector-set! key 0 0) (for/sum ([_ (in-range n)]) (let* ([u (for/fold ([best -1]) ([i (in-range n)]) (if (and (not (vector-ref in-mst i)) (or (= best -1) (< (vector-ref key i) (vector-ref key best)))) i best))]) (vector-set! in-mst u #t) (for ([edge (in-list (vector-ref adj u))]) (let ([v (car edge)] [w (cdr edge)]) (when (and (not (vector-ref in-mst v)) (< w (vector-ref key v))) (vector-set! key v w)))) (vector-ref key u))))"
