# Bellman-Ford: shortest paths with negative edges
# Graph: 0→1(4) 0→2(1) 1→3(1) 2→1(-2) 2→3(5) 3→4(3)
# Example: distances from 0 = (0 -1 1 0 3)
# expected: (0 -1 1 0 3)

bellman_ford:
  inputs:
    - n: "Number"
  bindings:
    n: "5"
  steps:
    - let_bind:
        bindings: "[edges (list (list 0 1 4) (list 0 2 1) (list 1 3 1) (list 2 1 -2) (list 2 3 5) (list 3 4 3))] [dist (make-vector n +inf.0)]"
        body: "(begin (vector-set! dist 0 0) (for ([_ (in-range (- n 1))]) (for ([e (in-list edges)]) (let ([u (first e)] [v (second e)] [w (third e)]) (when (< (+ (vector-ref dist u) w) (vector-ref dist v)) (vector-set! dist v (+ (vector-ref dist u) w)))))) (vector->list dist))"
