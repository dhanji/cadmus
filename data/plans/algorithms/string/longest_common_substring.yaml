# Longest common substring length
# Example: lcstr("ABABC", "BABCBA") = 4 ("BABC")
# expected: 4

longest_common_substring:
  inputs:
    - s1: "String"
    - s2: "String"
  bindings:
    s1: "\"ABABC\""
    s2: "\"BABCBA\""
  steps:
    - let_bind:
        bindings: "[m (string-length s1)] [n (string-length s2)] [dp (build-vector (+ (string-length s1) 1) (lambda (_) (make-vector (+ (string-length s2) 1) 0)))] [best (box 0)]"
        body: "(begin (for* ([i (in-range 1 (+ m 1))] [j (in-range 1 (+ n 1))]) (when (char=? (string-ref s1 (- i 1)) (string-ref s2 (- j 1))) (let ([v (+ (vector-ref (vector-ref dp (- i 1)) (- j 1)) 1)]) (vector-set! (vector-ref dp i) j v) (when (> v (unbox best)) (set-box! best v))))) (unbox best))"
