# Longest common subsequence length
# Example: lcs("ABCBDAB", "BDCAB") = 4
# expected: 4

longest_common_subsequence:
  inputs:
    - s1: "String"
    - s2: "String"
  bindings:
    s1: "\"ABCBDAB\""
    s2: "\"BDCAB\""
  steps:
    - let_bind:
        bindings: "[m (string-length s1)] [n (string-length s2)] [dp (build-vector (+ (string-length s1) 1) (lambda (_) (make-vector (+ (string-length s2) 1) 0)))]"
        body: "(begin (for* ([i (in-range 1 (+ m 1))] [j (in-range 1 (+ n 1))]) (vector-set! (vector-ref dp i) j (if (char=? (string-ref s1 (- i 1)) (string-ref s2 (- j 1))) (+ (vector-ref (vector-ref dp (- i 1)) (- j 1)) 1) (max (vector-ref (vector-ref dp (- i 1)) j) (vector-ref (vector-ref dp i) (- j 1)))))) (vector-ref (vector-ref dp m) n))"
