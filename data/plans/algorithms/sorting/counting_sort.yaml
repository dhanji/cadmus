# Counting sort: sort non-negative integers by counting occurrences
# Example: sort (4 2 2 8 3 3 1) = (1 2 2 3 3 4 8)
# expected: (1 2 2 3 3 4 8)

counting_sort:
  inputs:
    - lst: "List(Number)"
  bindings:
    lst: "(list 4 2 2 8 3 3 1)"
  steps:
    - let_bind:
        bindings: "[mx (apply max lst)] [counts (make-vector (+ mx 1) 0)]"
        body: "(begin (for-each (lambda (x) (vector-set! counts x (+ (vector-ref counts x) 1))) lst) (for*/list ([i (in-range (+ mx 1))] [_ (in-range (vector-ref counts i))]) i))"
