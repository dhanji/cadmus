# Matrix chain multiplication: minimum scalar multiplications
# Example: dims (10 30 5 60) â†’ 3 matrices, min cost = 4500
# expected: 4500

matrix_chain_multiplication:
  inputs:
    - n: "Number"
  bindings:
    n: "4"
  steps:
    - let_bind:
        bindings: "[dims (vector 10 30 5 60)] [n 3] [dp (build-vector 3 (lambda (_) (make-vector 3 0)))]"
        body: "(begin (for ([len (in-range 2 (+ n 1))]) (for ([i (in-range (- n len -1))]) (let ([j (+ i len -1)]) (vector-set! (vector-ref dp i) j +inf.0) (for ([k (in-range i j)]) (let ([cost (+ (vector-ref (vector-ref dp i) k) (vector-ref (vector-ref dp (+ k 1)) j) (* (vector-ref dims i) (vector-ref dims (+ k 1)) (vector-ref dims (+ j 1))))]) (when (< cost (vector-ref (vector-ref dp i) j)) (vector-set! (vector-ref dp i) j cost))))))) (exact-round (vector-ref (vector-ref dp 0) (- n 1))))"
