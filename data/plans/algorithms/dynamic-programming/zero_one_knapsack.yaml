# 0/1 Knapsack: maximize value within weight capacity
# Items: (weight, value) = (1,1) (3,4) (4,5) (5,7), capacity 7
# Example: max value = 9 (items 2+3: weight 3+4=7, value 4+5=9)
# expected: 9

zero_one_knapsack:
  inputs:
    - capacity: "Number"
  bindings:
    capacity: "7"
  steps:
    - vector_new: "1 3 4 5"
    - vector_new: "1 4 5 7"
    - vector_length: "$step-1"
    - add:
        x: "$capacity"
        y: "1"
    - make_vector:
        size: "$step-4"
        init: "0"
    - for_range:
        var: "i"
        start: "0"
        end: "$step-3"
        body:
          - for_range_down:
              var: "w"
              start: "$capacity"
              end:
                subtract:
                  x:
                    vector_ref:
                      v: "$step-1"
                      i: "$i"
                  y: "1"
              body:
                - vector_ref:
                    v: "$step-5"
                    i: "$w"
                - vector_ref:
                    v: "$step-1"
                    i: "$i"
                - subtract:
                    x: "$w"
                    y: "$body-2"
                - vector_ref:
                    v: "$step-5"
                    i: "$body-3"
                - vector_ref:
                    v: "$step-2"
                    i: "$i"
                - add:
                    x: "$body-4"
                    y: "$body-5"
                - max:
                    x: "$body-1"
                    y: "$body-6"
                - vector_set:
                    v: "$step-5"
                    i: "$w"
                    val: "$body-7"
    - vector_ref:
        v: "$step-5"
        i: "$capacity"
