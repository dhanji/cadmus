# Rod cutting: maximum revenue from cutting rod of length n
# Prices: length 1=1, 2=5, 3=8, 4=9, 5=10, 6=17, 7=17, 8=20
# Example: rod length 8 = 22 (cut into 2+6)
# expected: 22

rod_cutting:
  inputs:
    - n: "Number"
  bindings:
    n: "8"
  steps:
    - let_bind:
        bindings: "[prices (vector 0 1 5 8 9 10 17 17 20)] [dp (make-vector (+ n 1) 0)]"
        body: "(begin (for ([i (in-range 1 (+ n 1))]) (for ([j (in-range 1 (+ i 1))]) (vector-set! dp i (max (vector-ref dp i) (+ (vector-ref prices j) (vector-ref dp (- i j))))))) (vector-ref dp n))"
