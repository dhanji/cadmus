# Rod cutting: maximum revenue from cutting rod of length n
# Prices: length 1=1, 2=5, 3=8, 4=9, 5=10, 6=17, 7=17, 8=20
# Example: rod length 8 = 22 (cut into 2+6)
# expected: 22

rod_cutting:
  inputs:
    - n: "Number"
  bindings:
    n: "8"
  steps:
    - vector_new: "0 1 5 8 9 10 17 17 20"
    - add:
        x: "$n"
        y: "1"
    - make_vector:
        size: "$step-2"
        init: "0"
    - for_range:
        var: "i"
        start: "1"
        end:
          add:
            x: "$n"
            y: "1"
        body:
          - for_range:
              var: "j"
              start: "1"
              end:
                add:
                  x: "$i"
                  y: "1"
              body:
                - vector_ref:
                    v: "$step-3"
                    i: "$i"
                - vector_ref:
                    v: "$step-1"
                    i: "$j"
                - subtract:
                    x: "$i"
                    y: "$j"
                - vector_ref:
                    v: "$step-3"
                    i: "$body-3"
                - add:
                    x: "$body-2"
                    y: "$body-4"
                - max:
                    x: "$body-1"
                    y: "$body-5"
                - vector_set:
                    v: "$step-3"
                    i: "$i"
                    val: "$body-6"
    - vector_ref:
        v: "$step-3"
        i: "$n"
