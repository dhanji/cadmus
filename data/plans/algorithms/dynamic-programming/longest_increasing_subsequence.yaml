# Longest increasing subsequence length
# Example: LIS of (10 9 2 5 3 7 101 18) = 4
# expected: 4

longest_increasing_subsequence:
  inputs:
    - lst: "List(Number)"
  bindings:
    lst: "(list 10 9 2 5 3 7 101 18)"
  steps:
    - let_bind:
        bindings: "[n (length lst)] [dp (make-vector (length lst) 1)]"
        body: "(begin (for ([i (in-range 1 n)]) (for ([j (in-range i)]) (when (< (list-ref lst j) (list-ref lst i)) (vector-set! dp i (max (vector-ref dp i) (+ (vector-ref dp j) 1)))))) (for/fold ([mx 0]) ([i (in-range n)]) (max mx (vector-ref dp i))))"
