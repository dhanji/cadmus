# Longest palindromic subsequence length
# Example: LPS of "bbbab" = 4
# expected: 4

longest_palindromic_subsequence:
  inputs:
    - s: "String"
  bindings:
    s: "\"bbbab\""
  steps:
    - let_bind:
        bindings: "[n (string-length s)] [dp (build-vector (string-length s) (lambda (_) (make-vector (string-length s) 0)))]"
        body: "(begin (for ([i (in-range n)]) (vector-set! (vector-ref dp i) i 1)) (for ([len (in-range 2 (+ n 1))]) (for ([i (in-range (- n len -1))]) (let ([j (+ i len -1)]) (if (char=? (string-ref s i) (string-ref s j)) (vector-set! (vector-ref dp i) j (+ (vector-ref (vector-ref dp (+ i 1)) (- j 1)) 2)) (vector-set! (vector-ref dp i) j (max (vector-ref (vector-ref dp (+ i 1)) j) (vector-ref (vector-ref dp i) (- j 1)))))))) (vector-ref (vector-ref dp 0) (- n 1)))"
